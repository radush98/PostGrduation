function out=SubBytes(in)

% original
 S=[99   124   119   123   242   107   111   197    48     1   103    43   254   215   171   118;
   202   130   201   125   250    89    71   240   173   212   162   175   156   164   114   192;
   183   253   147    38    54    63   247   204    52   165   229   241   113   216    49    21;
     4   199    35   195    24   150     5   154     7    18   128   226   235    39   178   117;
     9   131    44    26    27   110    90   160    82    59   214   179    41   227    47   132;
    83   209     0   237    32   252   177    91   106   203   190    57    74    76    88   207;
   208   239   170   251    67    77    51   133    69   249     2   127    80    60   159   168;
    81   163    64   143   146   157    56   245   188   182   218    33    16   255   243   210;
   205    12    19   236    95   151    68    23   196   167   126    61   100    93    25   115;
    96   129    79   220    34    42   144   136    70   238   184    20   222    94    11   219;
   224    50    58    10    73     6    36    92   194   211   172    98   145   149   228   121;
   231   200    55   109   141   213    78   169   108    86   244   234   101   122   174     8;
   186   120    37    46    28   166   180   198   232   221   116    31    75   189   139   138;
   112    62   181   102    72     3   246    14    97    53    87   185   134   193    29   158;
   225   248   152    17   105   217   142   148   155    30   135   233   206    85    40   223;
   140   161   137    13   191   230    66   104    65   153    45    15   176    84   187    22];

% % method 1
%  S=[0,81,243,255,166,162,170,89,174,4,251,12,85,8,247,93;
%      97,195,207,16,178,186,105,182,20,203,28,190,24,199,109,101;
%      211,223,32,113,138,121,134,130,219,44,142,36,215,125,117,40;
%      239,48,65,227,73,150,146,154,60,158,52,235,77,69,56,231;
%      145,51,63,64,226,234,153,230,68,59,76,238,72,55,157,149;
%      3,15,80,161,250,169,246,242,11,92,254,84,7,173,165,88;
%      31,96,177,19,185,198,194,202,108,206,100,27,189,181,104,23;
%      112,129,35,47,214,210,218,137,222,116,43,124,133,120,39,141;
%      115,127,128,209,42,217,38,34,123,140,46,132,119,221,213,136;
%      79,144,225,67,233,54,50,58,156,62,148,75,237,229,152,71;
%      160,241,83,95,6,2,10,249,14,164,91,172,245,168,87,253;
%      193,99,111,176,18,26,201,22,180,107,188,30,184,103,205,197;
%      191,192,17,179,25,102,98,106,204,110,196,187,29,21,200,183;
%      208,33,131,143,118,114,122,41,126,212,139,220,37,216,135,45;
%      49,147,159,224,66,74,57,70,228,155,236,78,232,151,61,53;
%      163,175,240,1,90,9,86,82,171,252,94,244,167,13,5,248];
%  
% %method 2
%     S=[5, 0, 10, 122, 91, 161, 194, 101, 191, 103, 219, 244, 28, 145, 238, 188;
%         20, 30, 78, 25, 181, 214, 121, 111, 123, 239, 200, 131, 165, 242, 128, 32;
%         34, 82, 45, 40, 234, 77, 115, 137, 243, 220, 151, 79, 198, 148, 52, 185;
%         102, 49, 60, 54, 81, 71, 157, 254, 224, 171, 83, 199, 168, 8, 141, 218;
%         65, 75, 187, 70, 226, 3, 166, 152, 164, 24, 53, 252, 210, 47, 253, 93;
%         95, 143, 90, 85, 23, 186, 172, 246, 44, 9, 192, 184, 51, 193, 97, 230;
%         147, 110, 105, 99, 142, 176, 202, 43, 29, 212, 140, 48, 213, 117, 250, 7;
%         114, 125, 119, 167, 132, 222, 63, 146, 232, 144, 4, 33, 73, 206, 27, 233;
%         136, 248, 135, 130, 64, 231, 217, 35, 89, 118, 61, 229, 108, 62, 158, 19;
%         204, 155, 150, 156, 251, 237, 55, 84, 74, 1, 249, 109, 2, 162, 39, 112;
%         175, 170, 160, 208, 241, 11, 104, 207, 21, 205, 113, 94, 182, 59, 68, 22;
%         190, 180, 228, 179, 31, 124, 211, 197, 209, 69, 98, 41, 15, 88, 42, 138;
%         57, 196, 195, 201, 36, 26, 96, 129, 183, 126, 38, 154, 127, 223, 80, 173;
%         216, 215, 221, 13, 46, 116, 149, 56, 66, 58, 174, 139, 227, 100, 177, 67;
%         235, 225, 17, 236, 72, 169, 12, 50, 14, 178, 159, 86, 120, 133, 87, 247;
%         245, 37, 240, 255, 189, 16, 6, 92, 134, 163, 106, 18, 153, 107, 203, 76];

out=zeros(4);
for i=1:4
    for j=1:4
        temp=dec2hex(in(i,j),2);
        out(i,j)=S(hex2dec(temp(1))+1, hex2dec(temp(2))+1);
    end
end
        

end